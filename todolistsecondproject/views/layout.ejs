<!DOCTYPE html>
<html>
<head>
	<title></title>
	<link rel="stylesheet" href="http://cdn.bootcss.com/bootstrap/3.3.0/css/bootstrap.min.css">
    <link rel='stylesheet' href='/stylesheets/style.css' />
    <style>
    	.container{
    		width:650px;
    	}
    	.panel-footer{
    		overflow: hidden;
    	}
    	.done{
    		text-decoration: line-through;
    	}
    </style>
</head>
<body>
<div class="container">
	<div class="panel panel-info">
		<div class="panel-heading">
			<h3>Todo List</h3>
		</div>
		<div class="panel-body">
			<%- body%>
		</div>
		<div class="panel-footer">
			<div class="col-sm-2">
				<label class="control-label" for="content">
					todo
				</label>
			</div>
			<div class="col-sm-10">
				<input type="text" name="content" id="content" class="form-control">
			</div>
			<div class="form-group">
    			<div class="col-sm-offset-2 col-sm-10">
      				<button type="submit" class="btn btn-default" onclick="addContent()">confirm</button>
   				</div>
  			</div>
		</div>
	</div>
</div>
</body>
<script src="http://cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>
<script src="http://cdn.bootcss.com/bootstrap/3.3.0/js/bootstrap.min.js">
</script>
<script>
	var XHR = new XMLHttpRequest();
	function addContent(){
		var content = $('#content').val();
		XHR.open('GET','/add?content='+content);
		XHR.send();
		XHR.onreadystatechange = function(){
			if(XHR.readyState==4&&XHR.status == 200){
				var id = '"' + XHR.responseText + '"';
				var contentUl = $('#contentUl');
				var insertContent = "<li class='list-group-item'>"+
				"<span onclick='doneContent("+id+",this)'>" +content+"</span>"
				+"<button class='btn btn-danger' onclick="+"'deleteContent("+id+",this)'>delete</button></li>"
				contentUl.prepend(insertContent);
				$('#content').val("");
			}
		}
	}
	function deleteContent(id,obj){
		$(obj).parent().remove();
		XHR.open('GET','/delete?id='+id);
		XHR.send();
		XHR.onreadystatechange = function(){
			if(XHR.readyState == 4&&XHR.status == 200){
			}
		}
	}
	function doneContent(id,obj){
		$(obj).addClass('done');
		XHR.open('GET','/done?id='+id);
		XHR.send();
		XHR.onreadystatechange = function(){
			if(XHR.readyState == 4&&XHR.status == 200){
			}
		}
	}
</script>
</html>